version: 2.1
jobs:
  Builder:
   docker:
      - image: dopaemon/bionic:latest
   steps:
      - add_ssh_keys:
          fingerprints:
            - "e9:75:fa:04:22:99:6b:62:d9:45:a8:32:25:c5:01:c5"
      - run:
          name: Config
          no_output_timeout: 10m
          command: |
            git config --global user.name "dopaemon"
            git config --global user.email "polarisdp@gmail.com"
            mkdir -p ~/.ssh
            ssh-keyscan -H github.com >> ~/.ssh/known_hosts
      - run:
          name: Git Clone Repo
          no_output_timeout: 5m
          command: |
            git clone git@github.com:KernelPanic-OpenSource/KernelPanic-OpenSource.github.io.git ~/Repo
      - run:
          name: Building
          no_output_timeout: 5m
          command: |
            cd ~/Repo
            chmod +x packages.sh
            ./packages.sh
      - run:
          name: GitPush
          no_output_timeout: 5m
          command: |
            cd ~/Repo
            echo "yes" | git push -u origin master
workflows:
  version: 2.1
  cooking:
    jobs:
      - Builder
